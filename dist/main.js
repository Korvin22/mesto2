(()=>{"use strict";const e=".element-template",t=".elements__element";class n{constructor(e,t){this._config=e,this._form=t,this._selectorButton=this._config.button,this._input=this._config.input,this._inactiveButton=this._config.inactiveButton,this._activeButton=this._config.activeButton}enableValidation(){this._button=this._form.querySelector(this._selectorButton),this._form.addEventListener("input",(e=>this._handleFormInput(e,this._button)))}_handleFormInput(e){const t=e.target;this._showFieldError(t),this._setSubmitButtonState(this._button)}setDisabledState(){this._button.setAttribute("disabled",!0),this._button.classList.add(this._inactiveButton),this._button.classList.remove(this._activeButton)}_showFieldError(e){this._form.querySelector(`.${e.id}-error`).textContent=e.validationMessage}_setSubmitButtonState(){this._form.checkValidity()?(this._button.classList.remove(this._inactiveButton),this._button.classList.add(this._activeButton),this._button.removeAttribute("disabled","")):this.setDisabledState(this._button,this._config)}}class s{constructor(e,t,n){this._name=e.name,this._link=e.link,this._selector=t,this._handleCardClick=n}_getTemplate(){return document.querySelector(this._selector).content.querySelector(t).cloneNode(!0)}_removeCard(){console.log(this._element),this._element.remove(),this._element=null}_handleLikeClick(){this._buttonLike.classList.toggle("elements__like_active")}_setEventListeners(){this._buttonLike=this._element.querySelector(".elements__like"),this._element.querySelector(".elements__trash").addEventListener("click",(()=>{this._removeCard()})),this._buttonLike.addEventListener("click",(()=>{this._handleLikeClick()})),this._cardPicture.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}createCard(){return this._element=this._getTemplate(),this._cardPicture=this._element.querySelector(".elements__picture"),this._element.querySelector(".elements__title").textContent=this._name,this._cardPicture.alt=this._name,this._cardPicture.src=this._link,this._setEventListeners(),this._element}}class o{constructor(e){this.popup_selector=e,this.popup=document.querySelector(this.popup_selector)}openPopup(){console.log(this.popup),this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}closePopup(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&document.querySelector(".popup_opened").classList.remove("popup_opened")}setEventListeners(){this.popup.addEventListener("click",(e=>{(e.target===e.currentTarget||e.target.classList.contains("popup__button-close"))&&this.closePopup()}))}}class i extends o{constructor(e,t){super(e),this.callback=t,this.form=this.popup.querySelector(".popup__form"),this.input=this.popup.querySelector(".popup__input")}_getInputValues(){const e={};return this.input.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this.popup.addEventListener("click",(e=>{(e.target===e.currentTarget||e.target.classList.contains("popup__button-close"))&&this.closePopup()})),this.popup.querySelector(".popup__form").addEventListener("submit",this.callback)}closePopup(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),this.form.reset()}}const p=document.querySelector(".profile__open-popup"),r=document.querySelector(".profile__button-plus"),u=new i(".popup-edit",(function(e){e.preventDefault(),a.setUserInfo(),u.closePopup()})),l=new i(".popup-plus",(function(e){e.preventDefault();const t=b({name:h.value,link:m.value});k.addItem(t),d.reset(),l.closePopup(),f.setDisabledState()})),c=new class extends o{constructor(e){super(e)}openPopup({name:e,link:t}){const n=this.popup.querySelector(".popup__picture");this.popup.querySelector(".popup__caption").textContent=e,n.alt=e,n.src=t,this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}}(".popup-image"),a=new class{constructor(e,t){this.nameInputSelector=e,this.jobInputSelector=t,this.nameInput=document.querySelector(this.nameInputSelector),this.jobInput=document.querySelector(this.jobInputSelector),this.profileTitle=document.querySelector(".profile__title"),this.profileSubtitle=document.querySelector(".profile__subtitle")}getUserInfo(){this.nameInput.value=this.profileTitle.textContent,this.jobInput.value=this.profileSubtitle.textContent}setUserInfo(){this.profileTitle.textContent=this.nameInput.value,this.profileSubtitle.textContent=this.jobInput.value}}(".popup__input_type_name",".popup__input_type_job");u.setEventListeners(),l.setEventListeners(),c.setEventListeners();const _=document.querySelector(".popup__form_edit"),d=document.querySelector(".popup__form_plus");p.addEventListener("click",(()=>{u.openPopup(),a.getUserInfo()})),r.addEventListener("click",(function(){l.openPopup()}));const h=d.querySelector(".popup__input_type_title"),m=d.querySelector(".popup__input_type_reference");function v({name:e,link:t}){c.openPopup({name:e,link:t})}function b({name:t,link:n}){return new s({name:t,link:n},e,v).createCard()}document.querySelector(e).content.querySelector(t);const k=new class{constructor({items:e,renderer:t},n){this._items=e,this.renderer=t,this.containerSelector=n}addItem(e){document.querySelector(this.containerSelector).prepend(e)}renderInitialItems(){this._items.forEach((e=>{this.renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:({name:e,link:t})=>{const n=b({name:e,link:t});k.addItem(n)}},".elements");k.renderInitialItems(),new n({form:".popup__form_edit",button:".popup__button-save",inactiveButton:"popup__button-save_disabled",activeButton:"popup__button-save_abled",input:"popup__input"},_).enableValidation();const f=new n({form:".popup__form_plus",button:".popup__button-save",inactiveButton:"popup__button-save_disabled",activeButton:"popup__button-save_abled",input:"popup__input"},d);f.enableValidation()})();